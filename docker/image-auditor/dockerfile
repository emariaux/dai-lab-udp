# Uses a maven image to build the application.
FROM maven AS build

# Definies the workdir.
WORKDIR /app

# Copies pom.xml and source files to the workdir folder.
COPY pom.xml /app
COPY src /app/src

# Compiles the application with maven.
RUN mvn -B clean package

# Creates a Docker image based on Alpine Linux and install OpenJDK 20 on it.
FROM alpine:latest
RUN apk add --no-cache openjdk20

# Definies the workdir.
WORKDIR /app

# Copies the .jar file generated by maven to the workdir.
COPY --from=build /app/target/*.jar /app/app.jar

# Runs the application.
CMD ["java", "-jar", "app.jar"]